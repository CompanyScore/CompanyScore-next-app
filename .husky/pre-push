#!/bin/sh

# Get current branch name
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)

# Skip checks for main/master branches
if [ "$CURRENT_BRANCH" = "main" ] || [ "$CURRENT_BRANCH" = "master" ]; then
    echo "üöÄ Skipping checks for $CURRENT_BRANCH branch..."
    exit 0
fi

echo "üöÄ Running full checks before push..."

# –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã ‚Äî –≤–∫–ª—é—á–∏–º –ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –ø–æ—è–≤—è—Ç—Å—è
# npm run test -- --bail || (echo '‚ùå Tests failed'; false)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å TypeScript)
npx tsc --noEmit || (echo '‚ùå TypeScript typecheck failed'; false)

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build || (echo '‚ùå Build failed'; false)

echo "‚úÖ Pre-push checks passed. Pushing..."
