#!/bin/sh

# Get current branch name
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)

# Skip checks for main/master branches
if [ "$CURRENT_BRANCH" = "main" ] || [ "$CURRENT_BRANCH" = "master" ]; then
    echo "ğŸš€ Skipping checks for $CURRENT_BRANCH branch..."
    exit 0
fi

echo "ğŸš€ Running full checks before push..."

# Unit tests with Mocha
npm run test || (echo 'âŒ Tests failed'; false)

# TypeScript typecheck
npx tsc --noEmit || (echo 'âŒ TypeScript typecheck failed'; false)

# Project build
npm run build || (echo 'âŒ Build failed'; false)

echo "âœ… Pre-push checks passed. Pushing..."
