#!/bin/sh

# Get current branch name
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)

# Skip checks for main/master branches
if [ "$CURRENT_BRANCH" = "main" ] || [ "$CURRENT_BRANCH" = "master" ]; then
    echo "🚀 Skipping checks for $CURRENT_BRANCH branch..."
    exit 0
fi

echo "🚀 Running full checks before push..."

# Unit tests with Mocha
npm run test || (echo '❌ Tests failed'; false)

# TypeScript typecheck
npx tsc --noEmit || (echo '❌ TypeScript typecheck failed'; false)

# Project build
npm run build || (echo '❌ Build failed'; false)

echo "✅ Pre-push checks passed. Pushing..."
